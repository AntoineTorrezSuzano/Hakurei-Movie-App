# Appwrite Setup (2:05:00 of the tutorial)
## What differ from the tutorial
I have finished the Appwrite Setup part 

When I search something first time, it doesn't call the updateSearchCount() function \
It's because the data used it in the if statement is not yet updated

To resolve the flaw, things were changed in useFetch.ts \
Now it return the result when doing their things 


### search.tsx
First version :
```tsx
if(searchQuery.trim()) {
    await loadMovies();

    if (movies?.length > 0 && movies?.[0]) {
        await updateSearchCount(searchQuery, result[0]);
    }
} else {
    reset();
}
```

New version :
```tsx
if(searchQuery.trim()) {
    const result = await loadMovies();

    if (result && result.length > 0) {
        await updateSearchCount(searchQuery, result[0]);
    }
} else {
    reset();
}
```


and for the useFetch.ts :
First version : 
```tsx
const fetchData = async () => {
    try {
        setLoading(true);
        setError(null);

        const result = await fetchFunction();

        setData(result);
        // Nothing is returned
    } catch (err) {
        setError(err instanceof Error ? err : new Error('An error occurred'));

        // Nothing is returned
    } finally {
        setLoading(false);
    }
}
```
New version : 
```tsx
const fetchData = async () => {
    try {
        setLoading(true);
        setError(null);

        const result = await fetchFunction();

        setData(result);
        
        // Return the result so the caller can use it immediately
        return result;
    } catch (err) {
        setError(err instanceof Error ? err : new Error('An error occurred'));

        // Return null if there is an error
        return null;
    } finally {
        setLoading(false);
    }
}
```